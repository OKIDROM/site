(function(a){a.timer=function(t,e,n){this.set=function(a,e,n){this.init=!0;if("object"==typeof a){var h=["autostart","time"],r;for(r in h)void 0!=a[h[r]]&&eval(h[r]+" = func[paramList[arg]]");a=a.action}"function"==typeof a&&(this.action=a);isNaN(e)||(this.intervalTime=e);n&&!this.active&&(this.active=!0,this.setTimer());return this};this.once=function(a){var h=this;isNaN(a)&&(a=0);window.setTimeout(function(){h.action()},a);return this};this.play=function(a){this.active||(a?this.setTimer():this.setTimer(this.remaining),this.active=!0);return this};this.pause=function(){this.active&&(this.active=!1,this.remaining-=new Date-this.last,this.clearTimer());return this};this.stop=function(){this.active=!1;this.remaining=this.intervalTime;this.clearTimer();return this};this.toggle=function(a){this.active?this.pause():a?this.play(!0):this.play();return this};this.reset=function(){this.active=!1;this.play(!0);return this};this.clearTimer=function(){window.clearTimeout(this.timeoutObject)};this.setTimer=function(a){var e=this;"function"==typeof this.action&&(isNaN(a)&&(a=this.intervalTime),this.remaining=a,this.last=new Date,this.clearTimer(),this.timeoutObject=window.setTimeout(function(){e.go()},a))};this.go=function(){this.active&&(this.action(),this.setTimer())};if(this.init)return new a.timer(t,e,n);this.set(t,e,n);return this};a.fn.polyglotLanguageSwitcher=function(t){function e(c){g[c.name]&&g[c.name].call(a(this),c)}function n(){u||(e({name:"beforeOpen",element:p,instance:k}),l.addClass("active"),r(!0),setTimeout(function(){u=!0;e({name:"afterOpen",element:p,instance:k})},100))}function h(){u&&(e({name:"beforeClose",element:p,instance:k}),r(!1),l.removeClass("active"),u=!1,f&&f.active&&f.clearTimer(),e({name:"afterClose",element:p,instance:k}))}function r(a){"fade"==g.effect?a?q.fadeIn(g.animSpeed):q.fadeOut(g.animSpeed):a?q.slideDown(g.animSpeed):q.slideUp(g.animSpeed)}function x(c){h();var b=a(c).children(":first-child");c=a(b).attr("id");b=a(b).text();a(q).children().each(function(){a(this).detach()});for(var d=0;d<v.length;d++)a(v[d]).children(":first-child").attr("id")!=c&&q.append(v[d]);d=l.children(":first-child");l.attr("id",c);l.text(b);l.append(d)}function B(c){var b=a(c).attr("id"),d=a(c).attr("value");c=a(c).text();if(w)d=window.location.href,d=d.substring(d.lastIndexOf("/")+1),b=a('<li><a id="'+b+'" href="'+("http://"+document.domain+"/"+g.pagePrefix+b+"/"+d)+'">'+c+"</a></li>");else{var m=document.URL.replace("#",""),y=C();y[g.paramName]=d;0<m.indexOf("?")&&(m=m.substring(0,m.indexOf("?")));m+=D(y);b=a('<li><a id="'+b+'" href="'+m+'">'+c+"</a></li>")}b.bind("click",function(){e({name:"onChange",selectedItem:a(this).children(":first").attr("id"),element:p,instance:k});x(a(this))});"hover"==g.openMode&&b.hover(function(){f&&f.active&&f.pause()},function(){f&&f.play(!1)});return b}function C(){var a={},b=window.location.search.substr(1).split("&");if(0<b.length)for(var d=0;d<b.length;++d){var m=b[d].split("=");2==m.length&&(a[m[0]]=decodeURIComponent(m[1].replace(/\+/g," ")))}return a}function D(a){if(g.testMode)return"#";var b="?",d=0,c;for(c in a){var f="";0<d&&(f="&");b+=f+c+"="+a[c];d++}return b}var k=a.fn.polyglotLanguageSwitcher,p=a(this),z=a(this).attr("id"),l,q=a('<ul class="dropdown">'),A=0,u=!1,v=[],g=a.extend({},k.defaults,t),f,w="static"==g.websiteType;(function(){var c,b=a("#"+z+" > form > select > option");if(w){var d,e=window.location.href;b.each(function(){var c=a(this).attr("id");0<=e.indexOf("/"+c+"/")&&(d=c)})}b.each(function(){var b=a(this).attr("id");b=w?d===b:a(this).attr("selected");var e=B(a(this));b&&(c=e);v.push(e);0<A?q.append(e):(l=a('<a id="'+a(this).attr("id")+'" class="current" href="#">'+a(this).text()+' <span class="trigger">&raquo;</span></a>'),"hover"==g.openMode?l.hover(function(){n();f&&f.active&&f.pause()},function(){f&&f.play(!1)}):l.click(function(){n()}));A++});a("#"+z+" form:first-child").remove();p.append(l);p.append(q);c&&x(c)})();(function(){a(document).click(function(){h()});a(document).keyup(function(a){27==a.which&&h()});"hover"==g.openMode&&(f=a.timer(function(){h()}),f.set({time:g.hoverTimeout,autostart:!0}))})();k.open=function(){n()};k.close=function(){h()};e({name:"afterLoad",element:p,instance:k});return k};a.fn.polyglotLanguageSwitcher.defaults={openMode:"click",hoverTimeout:1500,animSpeed:200,effect:"slide",paramName:"lang",pagePrefix:"",websiteType:"dynamic",testMode:!1,onChange:NaN,afterLoad:NaN,beforeOpen:NaN,afterOpen:NaN,beforeClose:NaN,afterClose:NaN}})(jQuery);